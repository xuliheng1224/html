webpackJsonp([16],{"/zyI":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("vQ9I"),o=a("s0MJ"),l={data:function(){return{hosdetail:{},distDtoList:[],shi1:[],qu1:[],dialogImageUrl:[],dialogImageUrlStr:"",hosimg:[],miglist:[],auth:[]}},methods:{delimg:function(){this.hosdetail.photo=""},handleAvatarSuccess:function(t){this.hosdetail.photo=t.imagePath},beforeAvatarUpload:function(t){return t.type.indexOf("image/jpeg")>-1||t.type.indexOf("image/png")>-1?t.size/1024/1024<2?void 0:(this.$message.error("上传头像图片大小不能超过 2MB!"),!1):(this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),!1)},getHosDetail:function(){var t=this;Object(i.a)({url:"/crm/school/detail",method:"get",success:function(e){"0000"===e.data.code?(t.hosdetail=e.data.data.dto,t.distDtoList=e.data.data.distDtoList,t.getAreaByParentCode(0,t.hosdetail.provinceCode),t.getAreaByParentCode(1,t.hosdetail.cityCode),e.data.data.dto.img&&e.data.data.dto.img.split(",").forEach(function(e,a){t.hosimg.push({name:"",url:e})})):t.$message.error(e.data.msg)},fail:function(t){console.log(t)}},this)},getAreaByParentCode:function(t,e){var a=this;Object(i.a)({url:"/crm/school/getAreaByParentCode",method:"get",params:{type:t,parentCode:e},success:function(e){"0000"===e.data.code?0===t?a.shi1=e.data.data:a.qu1=e.data.data:a.$message.error(e.data.msg)},fail:function(t){console.log(t)}},this)},onSubmit:function(){var t=this;if(this.dialogImageUrl=[],this.hosimg.forEach(function(e,a){t.dialogImageUrl.push(e.url)}),this.dialogImageUrlStr=this.dialogImageUrl.join(","),this.hosdetail.provinceName&&this.hosdetail.cityName&&this.hosdetail.countyName){var e={hosName:this.hosdetail.hosName,level:this.hosdetail.level,provinceCode:this.hosdetail.provinceName.indexOf(",")>-1?this.hosdetail.provinceName:this.hosdetail.provinceCode+","+this.hosdetail.provinceName,cityCode:this.hosdetail.cityName.indexOf(",")>-1?this.hosdetail.cityName:this.hosdetail.cityCode+","+this.hosdetail.provinceName,countyCode:this.hosdetail.countyName.indexOf(",")>-1?this.hosdetail.countyName:this.hosdetail.countyCode+","+this.hosdetail.countyName,photo:this.hosdetail.photo,img:this.dialogImageUrlStr,intro:this.hosdetail.intro,tel:this.hosdetail.tel};Object(i.a)({url:"/crm/school/edit",method:"post",data:e,success:function(e){"0000"===e.data.code?t.$notify({title:"保存成功",type:"success"}):t.$message.error(e.data.msg)},fail:function(t){console.log(t)}},this)}else this.$message.error("请完善地址")},reload:function(){location.reload()},handleSuccess:function(t,e){this.hosimg.push({name:"",url:t.imagePath})},handleRemove:function(t){var e=this;this.hosimg.forEach(function(a,i){a.uid===t.uid&&e.hosimg.splice(i,1)})},choseProvince:function(t){this.hosdetail.cityName="",this.hosdetail.countyName="",this.getAreaByParentCode(0,t.split(",")[0])},choseCity:function(t){this.hosdetail.countyName="",this.getAreaByParentCode(1,t.split(",")[0])}},mounted:function(){this.getHosDetail(),this.auth=o.tool.localStorage.get("authTags")}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hostpital_content"},[t._m(0),t._v(" "),a("div",[a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"医院名称:"}},[a("el-input",{staticStyle:{width:"550px"},model:{value:t.hosdetail.hosName,callback:function(e){t.$set(t.hosdetail,"hosName","string"==typeof e?e.trim():e)},expression:"hosdetail.hosName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"医院等级:"}},[a("el-select",{staticStyle:{width:"550px"},model:{value:t.hosdetail.level,callback:function(e){t.$set(t.hosdetail,"level",e)},expression:"hosdetail.level"}},[a("el-option",{attrs:{label:"一级甲等",value:"一级甲等"}}),t._v(" "),a("el-option",{attrs:{label:"一级乙等",value:"一级乙等"}}),t._v(" "),a("el-option",{attrs:{label:"一级丙等",value:"一级丙等"}}),t._v(" "),a("el-option",{attrs:{label:"二级甲等",value:"二级甲等"}}),t._v(" "),a("el-option",{attrs:{label:"二级乙等",value:"二级乙等"}}),t._v(" "),a("el-option",{attrs:{label:"二级丙等",value:"二级丙等"}}),t._v(" "),a("el-option",{attrs:{label:"三级甲等",value:"三级甲等"}}),t._v(" "),a("el-option",{attrs:{label:"三级乙等",value:"三级乙等"}}),t._v(" "),a("el-option",{attrs:{label:"三级丙等",value:"三级丙等"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"医院地址:"}},[a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"省级地区"},on:{change:t.choseProvince},model:{value:t.hosdetail.provinceName,callback:function(e){t.$set(t.hosdetail,"provinceName",e)},expression:"hosdetail.provinceName"}},t._l(t.distDtoList,function(t){return a("el-option",{key:t.pid,attrs:{label:t.name,value:t.code+","+t.name}})})),t._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"市级地区"},on:{change:t.choseCity},model:{value:t.hosdetail.cityName,callback:function(e){t.$set(t.hosdetail,"cityName",e)},expression:"hosdetail.cityName"}},t._l(t.shi1,function(t){return a("el-option",{key:t.pid,attrs:{label:t.name,value:t.code+","+t.name}})})),t._v(" "),a("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"区级地区"},model:{value:t.hosdetail.countyName,callback:function(e){t.$set(t.hosdetail,"countyName",e)},expression:"hosdetail.countyName"}},t._l(t.qu1,function(t){return a("el-option",{key:t.pid,attrs:{label:t.name,value:t.code+","+t.name}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"医院封面:"}},[a("img",{staticStyle:{width:"300px"},attrs:{src:t.hosdetail.photo,alt:""}}),t._v(" "),a("div",{staticStyle:{width:"300px",display:"flex","justify-content":"center"}},[a("el-upload",{attrs:{action:"/msg/upload","show-file-list":!1,"before-upload":t.beforeAvatarUpload,"on-success":t.handleAvatarSuccess,name:"img"}},[a("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"}},[t._v("更换")])],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.delimg}},[t._v("删除")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"医院相册:"}},[a("el-upload",{attrs:{action:"/msg/upload","list-type":"picture-card","before-upload":t.beforeAvatarUpload,"on-success":t.handleSuccess,"on-remove":t.handleRemove,name:"img","file-list":t.hosimg,limit:5}},[a("i",{staticClass:"el-icon-plus"}),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"},attrs:{slot:"tip"},slot:"tip"},[a("p",[t._v("上传的图片将显示在学校列表页和学校详情页")]),t._v(" "),a("p",[t._v("图片1—5张，建议像素：xx*xx")]),t._v(" "),a("p",[t._v("支持扩展名：.jpg，.png")])])])],1),t._v(" "),a("el-form-item",{attrs:{label:"医院简介:"}},[a("el-input",{staticStyle:{width:"550px"},attrs:{type:"textarea",rows:10,placeholder:"请输入医院简介"},model:{value:t.hosdetail.intro,callback:function(e){t.$set(t.hosdetail,"intro",e)},expression:"hosdetail.intro"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系电话:"}},[a("el-input",{staticStyle:{width:"550px"},model:{value:t.hosdetail.tel,callback:function(e){t.$set(t.hosdetail,"tel",e)},expression:"hosdetail.tel"}})],1),t._v(" "),a("el-form-item",[t.auth.indexOf("hos_edit_submit")>-1?a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]):t._e(),t._v(" "),a("el-button",{on:{click:t.reload}},[t._v("取消")])],1)],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hostpital_header"},[e("div",[this._v("医院信息管理")])])}]};var n=a("VU/8")(l,s,!1,function(t){a("mAxC")},"data-v-a4fdffb0",null);e.default=n.exports},mAxC:function(t,e){}});