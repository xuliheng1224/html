webpackJsonp([15],{"H+Zj":function(t,e){},wn2s:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("NYxO"),i=a("vQ9I"),l=a("s0MJ"),s={computed:Object(r.mapState)({doctordata:function(t){return t.doctorInfo.doctorinfo}}),data:function(){return{keyword:"",pageSize:10,page:"",centerDialogVisible:!1,editDialogVisible:!1,options:[],doctorVal:"",imageUrl:"",lecturer:{},authTagsArr:[]}},mounted:function(){this.authTagsArr=l.tool.localStorage.get("authTags"),console.log(this.authTagsArr.indexOf("lecture_edit_submit")),this.getDoctorData()},methods:{formatterCreate:function(t,e){return new Date(t.createTime).toLocaleString()},formatterUpdate:function(t,e){return new Date(t.updateTime).toLocaleString()},getDoctorData:function(){this.$store.dispatch("getLecturerList",{_this:this,pageSize:this.pageSize,page:1})},handleCurrentChange:function(t){this.page=t,this.$store.dispatch("getLecturerList",{_this:this,pageSize:this.pageSize,page:this.page})},handleSizeChange:function(t){this.$store.dispatch("getLecturerList",{_this:this,pageSize:t,page:1})},searchDoctorData:function(){this.$store.dispatch("getLecturerList",{_this:this,keyword:this.keyword,pageSize:this.page,page:1})},addDoctor:function(){var t=this;this.centerDialogVisible=!0,Object(i.a)({url:"/crm/lecturer/doctor/list",method:"get",params:{pageSize:200},success:function(e){t.options=e.data.data},fail:function(t){console.log(t)}})},saveDoctor:function(){var t=this;Object(i.a)({url:"/crm/lecturer/insert/"+this.doctorVal,method:"post",success:function(e){"0000"===e.data.code?(t.$message({message:"添加成功",type:"success"}),t.centerDialogVisible=!1,t.getDoctorData()):t.$message.error(e.data.msg)},fail:function(t){console.log(t)}})},editClick:function(t){var e=this;Object(i.a)({url:"/crm/lecturer/edit",method:"get",params:{lecturerId:t},success:function(t){"0000"===t.data.code?(e.editDialogVisible=!0,e.options=t.data.data.titleList,e.lecturer=t.data.data.lecturer):e.$message.error(t.data.msg)},fail:function(t){console.log(t)}})},selectChange:function(t){var e;e=this.options.find(function(e){return e.titleId===t}),this.lecturer.titleId=e.titleId,this.lecturer.titleName=e.name},handleAvatarSuccess:function(t){this.lecturer.photo=t.imagePath},beforeAvatarUpload:function(t){return t.type.indexOf("image/jpeg")>-1||t.type.indexOf("image/png")>-1?t.size/1024/1024<2?void 0:(this.$message.error("上传头像图片大小不能超过 2MB!"),!1):(this.$message.error("  JPG 或 PNG 格式!"),!1)},saveDoctorInfo:function(){var t=this;if(this.lecturer.lecturerName&&this.lecturer.photo&&this.lecturer.titleName&&this.lecturer.lecturerIntro){var e={doctorId:this.lecturer.doctorId,lecturerId:this.lecturer.lecturerId,lecturerIntro:this.lecturer.lecturerIntro,lecturerName:this.lecturer.lecturerName,photo:this.lecturer.photo,titleId:this.lecturer.titleId,titleName:this.lecturer.titleName};Object(i.a)({url:"/crm/lecturer/save",method:"post",data:e,success:function(e){"0000"===e.data.code?(t.editDialogVisible=!1,t.handleCurrentChange(t.page)):t.$message.error(e.data.msg)},fail:function(t){console.log(t)}},this)}else this.$message.error("请完善信息")}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",{staticClass:"search"},[a("div",{staticClass:"search_box"},[a("div",[t._v("讲师姓名")]),t._v(" "),a("div",{staticClass:"search_input"},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.searchDoctorData}},[t._v("搜索")])],1)]),t._v(" "),a("div",{staticClass:"search_table"},[t.authTagsArr.indexOf("lecture_add")>-1?a("div",{staticClass:"search_add",on:{click:t.addDoctor}},[a("i",{staticClass:"el-icon-circle-plus"}),t._v(" "),a("span",[t._v("添加")])]):t._e(),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.doctordata.data,stripe:"","default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"lecturerId",label:"编号",width:"400"}}),t._v(" "),a("el-table-column",{attrs:{prop:"lecturerName",label:"姓名","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"lecturerLevel",label:"职称","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"200",formatter:t.formatterCreate}}),t._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"200",formatter:t.formatterUpdate}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.authTagsArr.indexOf("lecture_edit")>-1?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.editClick(e.row.lecturerId)}}},[t._v("编辑\n              ")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"paging"},[a("el-pagination",{attrs:{"page-size":t.doctordata.pageSize,"page-sizes":[10,50,100],layout:"total, sizes, prev, pager, next, jumper",total:t.doctordata.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"添加讲师",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("div",[a("span",{staticStyle:{"padding-right":"20px"}},[t._v("讲师姓名")]),a("span",[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.doctorVal,callback:function(e){t.doctorVal=e},expression:"doctorVal"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.text,value:t.value}})}))],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.saveDoctor}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"编辑信息",visible:t.editDialogVisible,width:"50%",center:""},on:{"update:visible":function(e){t.editDialogVisible=e}}},[a("div",{staticClass:"dialog"},[a("span",{staticClass:"left_title"},[t._v("讲师姓名")]),a("span",{staticClass:"right_input"},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.lecturer.lecturerName,callback:function(e){t.$set(t.lecturer,"lecturerName","string"==typeof e?e.trim():e)},expression:"lecturer.lecturerName"}})],1)]),t._v(" "),a("div",{staticClass:"dialog"},[a("span",{staticClass:"left_title"},[t._v("讲师头像")]),a("span",{staticClass:"right_input"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/msg/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,name:"img"}},[a("el-button",{attrs:{type:"primary"}},[t._v("上传头像")]),t._v(" "),t.lecturer.photo?a("img",{staticClass:"avatar",attrs:{src:t.lecturer.photo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)]),t._v(" "),a("div",{staticClass:"dialog"},[a("span",{staticClass:"left_title"},[t._v("讲师职称")]),a("span",{staticClass:"right_input"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.lecturer.titleName,callback:function(e){t.$set(t.lecturer,"titleName",e)},expression:"lecturer.titleName"}},t._l(t.options,function(t){return a("el-option",{key:t.titleId,attrs:{label:t.name,value:t.titleId}})}))],1)]),t._v(" "),a("div",{staticClass:"dialog"},[a("span",{staticClass:"left_title"},[t._v("讲师简介")]),a("span",{staticClass:"right_input"},[a("el-input",{attrs:{type:"textarea",rows:4,maxlength:"150",placeholder:"请输入内容"},model:{value:t.lecturer.lecturerIntro,callback:function(e){t.$set(t.lecturer,"lecturerIntro",e)},expression:"lecturer.lecturerIntro"}})],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",staticStyle:{"padding-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("div",{staticStyle:{height:"20px"}}),t._v(" "),a("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),t.authTagsArr.indexOf("lecture_edit_submit")>-1?a("el-button",{attrs:{type:"primary"},on:{click:t.saveDoctorInfo}},[t._v("确 定")]):t._e()],1)])],1)},staticRenderFns:[]};var c=a("VU/8")(s,o,!1,function(t){a("H+Zj")},"data-v-fdee4464",null);e.default=c.exports}});